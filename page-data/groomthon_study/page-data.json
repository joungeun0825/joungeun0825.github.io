{"componentChunkName":"component---src-templates-post-jsx","path":"/groomthon_study/","result":{"data":{"site":{"siteMetadata":{"title":"mythofsummer"}},"markdownRemark":{"id":"581d4e78-0d4c-5286-8bab-a61eeed9095b","excerpt":"이 글은 구름톤 유니브에서 들은 강의를 정리한 내용입니다. 이미지를 업로드하고, opencv를 사용하여 이미지에서 얼굴을 탐지하는 웹 서비스를 만들어보겠습니다. 이미지 DB에 저장하기 이미지 업로드 기능을 처리할 수 있는 모델을 정의한 코드입니다. 이 모델은 사용자가 업로드한 이미지 파일과 그에 대한 메타데이터(설명, 업로드된 시간)를 관리합니다. Dja…","html":"<p>이 글은 구름톤 유니브에서 들은 강의를 정리한 내용입니다. 이미지를 업로드하고, opencv를 사용하여 이미지에서 얼굴을 탐지하는 웹 서비스를 만들어보겠습니다.</p>\n<h2 id=\"이미지-DB에-저장하기\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-DB%EC%97%90-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"이미지 DB에 저장하기 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>이미지 DB에 저장하기</h2>\n<p>이미지 업로드 기능을 처리할 수 있는 모델을 정의한 코드입니다. 이 모델은 사용자가 업로드한 이미지 파일과 그에 대한 메타데이터(설명, 업로드된 시간)를 관리합니다. Django의 ORM을 통해 데이터베이스에 매핑되며, 이를 사용해 이미지와 관련된 데이터를 저장하고 관리할 수 있습니다. 코드의 각 부분을 자세히 설명해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ImageUploadModel</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    description <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>CharField<span class=\"token punctuation\">(</span>max_length<span class=\"token operator\">=</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> blank<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    document <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>ImageField<span class=\"token punctuation\">(</span>upload_to<span class=\"token operator\">=</span><span class=\"token string\">'images/%Y/%m/%d'</span><span class=\"token punctuation\">)</span>\n    uploaded_at <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>DateTimeField<span class=\"token punctuation\">(</span>auto_now_add<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"description-필드\" style=\"position:relative;\"><a href=\"#description-%ED%95%84%EB%93%9C\" aria-label=\"description 필드 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>description 필드</h3>\n<p>이 필드는 업로드된 이미지에 대한 설명을 저장하는 텍스트 필드입니다. 이 필드의 최대 길이는 255자로 제한합니다. 폼에서 이 필드를 빈 채로 제출하는 것을 허용하여 사용자가 설명을 생략해도 오류가 발생하지 않으며, is_valid() 함수에서 유효한 데이터로 간주됩니다.</p>\n<h3 id=\"document-필드\" style=\"position:relative;\"><a href=\"#document-%ED%95%84%EB%93%9C\" aria-label=\"document 필드 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>document 필드</h3>\n<p>실제 이미지 파일을 저장하는 필드입니다. Django의 이미지 전용 필드로, 이미지 업로드를 다룰 때 사용합니다. 파일이 저장될 경로를 지정합니다. 여기서 %Y, %m, %d는 각각 업로드 시점의 연도, 월, 일을 나타냅니다. 예를 들어, 2024년 10월 3일에 업로드된 파일은 /images/2024/10/03/ 폴더 아래에 저장됩니다.</p>\n<h3 id=\"uploaded_at-필드\" style=\"position:relative;\"><a href=\"#uploaded_at-%ED%95%84%EB%93%9C\" aria-label=\"uploaded_at 필드 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>uploaded_at 필드</h3>\n<p>파일이 업로드된 시간을 저장하는 필드입니다. 객체가 처음 생성될 때 현재 날짜와 시간이 자동으로 저장됩니다. 이후에는 수정되지 않습니다.</p>\n<h2 id=\"폼으로-사용자에게-받은-데이터-처리하기\" style=\"position:relative;\"><a href=\"#%ED%8F%BC%EC%9C%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%97%90%EA%B2%8C-%EB%B0%9B%EC%9D%80-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"폼으로 사용자에게 받은 데이터 처리하기 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>폼으로 사용자에게 받은 데이터 처리하기</h2>\n<p>이 코드는 Django의 폼을 정의한 것으로, 사용자로부터 데이터를 입력받아 처리하는 방식입니다. 여기서는 두 가지 폼을 다룹니다: SimpleUploadForm과 ImageUploadForm. 각각의 폼이 어떤 역할을 하는지 살펴보겠습니다.</p>\n<h3 id=\"SimpleUploadForm\" style=\"position:relative;\"><a href=\"#SimpleUploadForm\" aria-label=\"SimpleUploadForm permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>SimpleUploadForm</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SimpleUploadForm</span><span class=\"token punctuation\">(</span>forms<span class=\"token punctuation\">.</span>Form<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    title <span class=\"token operator\">=</span> forms<span class=\"token punctuation\">.</span>CharField<span class=\"token punctuation\">(</span>max_length<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n    image <span class=\"token operator\">=</span> forms<span class=\"token punctuation\">.</span>ImageField<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><strong>SimpleUploadForm</strong>은 forms.Form 클래스를 상속받아 직접 정의한 폼입니다. 이 폼은 이미지를 업로드하는 가장 기본적인 기능을 구현합니다.</li>\n</ul>\n<p><strong>필드 설명</strong></p>\n<ul>\n<li>title = forms.CharField(max_length=50): 최대 50자까지 입력 가능한 텍스트 필드입니다. 사용자가 업로드한 이미지의 제목을 입력할 수 있습니다.</li>\n<li>image = forms.ImageField(): 이미지를 업로드할 수 있는 필드입니다. ImageField는 FileField를 상속받아, 이미지 파일인지 확인하는 추가 유효성 검사를 합니다.</li>\n</ul>\n<p>이 폼은 간단한 이미지 업로드와 제목 입력 기능을 제공하는데, 폼 필드가 고정되어 있어 어떤 모델에도 종속되지 않습니다. 따라서 데이터를 모델에 직접 연결하지 않는 경우에 주로 사용됩니다.</p>\n<h3 id=\"ImageUploadForm\" style=\"position:relative;\"><a href=\"#ImageUploadForm\" aria-label=\"ImageUploadForm permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ImageUploadForm</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ImageUploadForm</span><span class=\"token punctuation\">(</span>forms<span class=\"token punctuation\">.</span>ModelForm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">Meta</span><span class=\"token punctuation\">:</span>\n        model <span class=\"token operator\">=</span> ImageUploadModel\n        fields <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'description'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'document'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><strong>ImageUploadForm</strong>은 forms.ModelForm을 상속받아 모델과 연결된 폼을 생성합니다. 이 폼은 데이터베이스 모델인 ImageUploadModel과 직접 연결되어 있어, 사용자가 입력한 데이터가 바로 모델의 필드에 매핑됩니다.</li>\n</ul>\n<p><strong>메타 데이터</strong></p>\n<ul>\n<li>model = ImageUploadModel: 이 폼이 연결된 모델을 명시합니다. ImageUploadModel은 업로드된 이미지와 설명을 저장하는 모델입니다.</li>\n<li>fields = ('description', 'document', ): 사용자가 입력할 수 있는 필드 목록입니다. description과 document만을 입력받고, uploaded_at 필드는 자동으로 설정되므로 입력받지 않습니다.</li>\n</ul>\n<h2 id=\"이미지에-Face-detection-적용하기\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80%EC%97%90-Face-detection-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"이미지에 Face detection 적용하기 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>이미지에 Face detection 적용하기</h2>\n<p>아래 코드를 통해 본격적으로 이미지에서 얼굴과 눈을 탐지하게 됩니다. OpenCV에서 제공하는 Haar Cascade Classifier를 사용하여 구현하게 됩니다. 코드를 자세히 알아보겠습니다.</p>\n<h3 id=\"기본적인-이미지-처리\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9D%B8-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B2%98%EB%A6%AC\" aria-label=\"기본적인 이미지 처리 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>기본적인 이미지 처리</h3>\n<p>먼저, 이미지를 받아와서 얼굴과 눈을 탐지하는 과정이 필요하겠죠? 이를 위해 이미지 파일을 cv2.imread()를 사용해 읽어옵니다. OpenCV는 이미지를 NumPy 배열 형태로 다루기 때문에, 이미지가 정상적으로 로드됐는지 확인하는 것이 중요합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>ndarray<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<p>위 코드에서는 이미지를 성공적으로 로드했을 때, 그 이미지의 크기(가로, 세로, 채널)를 출력합니다. 이제 이미지가 너무 클 경우를 대비해 크기를 조정하는 과정을 추가해 보겠습니다.</p>\n<h3 id=\"이미지-크기-조정\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%81%AC%EA%B8%B0-%EC%A1%B0%EC%A0%95\" aria-label=\"이미지 크기 조정 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>이미지 크기 조정</h3>\n<p>이미지의 가로가 640px보다 크거나, 세로가 480px보다 크면 크기를 축소해줍니다. 이렇게 하면 너무 큰 이미지로 인해 처리 속도가 느려지는 것을 방지할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">resize_needed <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\n<span class=\"token keyword\">if</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">640</span><span class=\"token punctuation\">:</span> \n    resize_needed <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n    new_w <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">640.0</span> <span class=\"token operator\">/</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    new_h <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">640.0</span> <span class=\"token operator\">/</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">elif</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">480</span><span class=\"token punctuation\">:</span>\n    resize_needed <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n    new_w <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">480.0</span> <span class=\"token operator\">/</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    new_h <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">480.0</span> <span class=\"token operator\">/</span> img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> resize_needed<span class=\"token punctuation\">:</span>\n    img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>new_w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>new_h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>여기서 resize_needed 플래그를 사용해 이미지 크기 조정이 필요한 경우에만 리사이즈를 진행합니다. 가로 또는 세로가 기준보다 크면, 해당 비율에 맞게 크기를 줄입니다.</p>\n<h3 id=\"얼굴과-눈-탐지\" style=\"position:relative;\"><a href=\"#%EC%96%BC%EA%B5%B4%EA%B3%BC-%EB%88%88-%ED%83%90%EC%A7%80\" aria-label=\"얼굴과 눈 탐지 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>얼굴과 눈 탐지</h3>\n<p>이제 본격적으로 얼굴과 눈을 탐지해볼 차례입니다. OpenCV에서 제공하는 Haar Cascade Classifier를 사용해 얼굴과 눈을 탐지할 수 있는데요, 미리 학습된 모델을 활용하여 빠르게 얼굴과 눈을 찾을 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">face_cascade <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>CascadeClassifier<span class=\"token punctuation\">(</span>baseUrl <span class=\"token operator\">+</span> <span class=\"token string\">'haarcascade_frontalface_default.xml'</span><span class=\"token punctuation\">)</span>\neye_cascade <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>CascadeClassifier<span class=\"token punctuation\">(</span>baseUrl <span class=\"token operator\">+</span> <span class=\"token string\">'haarcascade_eye.xml'</span><span class=\"token punctuation\">)</span>\ngray <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2GRAY<span class=\"token punctuation\">)</span>\nfaces <span class=\"token operator\">=</span> face_cascade<span class=\"token punctuation\">.</span>detectMultiScale<span class=\"token punctuation\">(</span>gray<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>먼저, 이미지를 그레이스케일로 변환한 후 얼굴을 탐지합니다. 여기서 detectMultiScale() 함수는 얼굴을 찾기 위한 주요 함수입니다. 탐지된 얼굴의 좌표를 바탕으로 사각형을 그려주는 작업도 같이 진행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> faces<span class=\"token punctuation\">:</span>\n    cv2<span class=\"token punctuation\">.</span>rectangle<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">+</span>w<span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span>h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n    roi_gray <span class=\"token operator\">=</span> gray<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">:</span>y<span class=\"token operator\">+</span>h<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">:</span>x<span class=\"token operator\">+</span>w<span class=\"token punctuation\">]</span>\n    roi_color <span class=\"token operator\">=</span> img<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">:</span>y<span class=\"token operator\">+</span>h<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">:</span>x<span class=\"token operator\">+</span>w<span class=\"token punctuation\">]</span>\n    eyes <span class=\"token operator\">=</span> eye_cascade<span class=\"token punctuation\">.</span>detectMultiScale<span class=\"token punctuation\">(</span>roi_gray<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">,</span> ey<span class=\"token punctuation\">,</span> ew<span class=\"token punctuation\">,</span> eh<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> eyes<span class=\"token punctuation\">:</span>\n        cv2<span class=\"token punctuation\">.</span>rectangle<span class=\"token punctuation\">(</span>roi_color<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">,</span> ey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>ex<span class=\"token operator\">+</span>ew<span class=\"token punctuation\">,</span> ey<span class=\"token operator\">+</span>eh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>얼굴을 찾은 후에는 그 영역을 기반으로 다시 눈을 탐지합니다. 얼굴 영역 내에서 눈을 찾고, 해당 부분에도 사각형을 그려줍니다. 얼굴은 파란색 사각형으로, 눈은 녹색 사각형으로 표시됩니다.</p>\n<h3 id=\"결과-이미지-저장\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%A0%80%EC%9E%A5\" aria-label=\"결과 이미지 저장 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>결과 이미지 저장</h3>\n<p>얼굴과 눈을 찾았으면 이제 그 결과를 이미지 파일로 저장해야겠죠? 이를 위해 cv2.imwrite() 함수를 사용해 원본 파일 경로에 덮어쓰거나, 새로운 파일을 생성해 저장할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cv2<span class=\"token punctuation\">.</span>imwrite<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span></code></pre></div>\n<p>이렇게 하면 얼굴과 눈이 탐지된 이미지가 저장됩니다.</p>\n<h2 id=\"화면-구성\" style=\"position:relative;\"><a href=\"#%ED%99%94%EB%A9%B4-%EA%B5%AC%EC%84%B1\" aria-label=\"화면 구성 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>화면 구성</h2>\n<p>먼저 화면을 구성하는 코드를 알아보겠습니다. 간단히 <strong>이미지를 간단히 업로드하는 기능, 얼굴 탐지 기능</strong>으로 나눠져 있는데요. 아래에서 더 자세히 알아보겠습니다.</p>\n<h3 id=\"간단한-이미지-업로드\" style=\"position:relative;\"><a href=\"#%EA%B0%84%EB%8B%A8%ED%95%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%97%85%EB%A1%9C%EB%93%9C\" aria-label=\"간단한 이미지 업로드 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>간단한 이미지 업로드</h3>\n<p>다음은 이미지를 간단히 업로드하는 기능입니다. 이 뷰는 GET 요청일 때는 빈 폼을 보여주고, POST 요청일 때는 사용자가 업로드한 이미지를 처리합니다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/30868430e00f825c56a5ca65ac7c926f/994d6/image-1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 87.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABJ0AAASdAHeZh94AAAENklEQVR42p2Ua0yTVxiAGxPFkBnxvikDnYCiWDYZ6rQqiCg4r0CQDdSgG8woSMwUN4PLNqcYIzIilM2pIEMZM7MK46og6BQ0EMhaKAiVCSgUuVS3Ukrh2WnL9md/yE7y5vu+nDfPeb9z3vNIAgICCAoMJDAwiC1bA9i8eSsbNmzE3xz+G1nttYaVK71GHZLmpiaaRGg0GjTNzbS0tPDkiYbGxkbU6gZ6e3sZGBjAYDCMKiTq+npUKhXNAlgv3ltb2ywwpVIpwC0C2Id5DA8PM5oh6evrQ6fT0d+vxyCiX69nyGSyTA4NDf0LM5kGMYpKjcYBy3PQaGRw0GjJNef9kyvp7e6mp6eHblGJXj/AKwE1T462ov9UWFZVSWnxHRofFvGgLIOWvFs8VyvRGw0UFd6mQ9PCq1ddlBfncT4pCXlSAsmJCeTnXKesWIHybok4AzV/dHVagem3FRRmZ1BQdIXUjwK4FOZHcvx2Uk7F8HNqOv26XjpetJIQe5jti5xJ2ruRuG2ebFm7hIjdvnz/TSRXryRQrKy2AvMelVNcnUtuWgbKr+SkJX7AiRgPkg/6UpD1LbqXWnTaLipu/ErW/hDa0w5ScXoHvjI3jh7axckv9pCQGsvdxt+twF8ellKQdoGmsxkMdnWTkXCa72IDiAmRIXWZxYqlizkR+xnvrZCxzN2NylMRHA2SIRljwxxHe344E8Glq4ncqa+1AnPKiqk6nkJ7vYp8UcXJI19Tp1Dg/qYDs2e+znS7CUyeNJFx48bzxiwHYvftxc/Hh7E2tthNmiL29QjZN+SUqGqswKyiXOpKy0g/d55dQeE8Fv14X3GTEM+FHAheS5jPEuxnTGPqlGm42M9g0gRb5s6azvSpkxkjFomK/JCLl7+ktG4EeLHoJh/vjODMoaPEhIewdZ0XUncp56KD+TP3FLeP72CV52IWzXdhldQF/6VS/N92Ysk8B8aOt0XmMYfM7HjKG1RWYFqBQtzfYEK9vQhduQA/9zk4O8wk9pM93IoLJXrTcrxXeeM025EjwV7U/nSS31I/Jer9ZUgkEqSujly+lszdhpFDuV5Ryv2cPH78/ACZ8ftoypMTF76J9Wt8OBgZyRqZDM93FmMnfjl6nZSe7GNoc+KoKcgkXS5n/XIPdu4Pp/KJeqRtqu/x4JqClH276SiMx/Qgnehtq5nnNI/1Xt64uboy1/EtbGxfY39YGIqobVRdOIbJoBd3c5jexw2kyBMpqRvpw+zyQjb7+eDs/C6HdwVxJiqIhS6OuIo9m+/sxIL5C3B3kzLRbjI3MrNoLb9HQ34B2ppa+tqfYRIeUIkeLFFVWYHtnc9R1impVzdS+aiN8nsaqqqfUlvTxtOn7Wi1Wjo7Omhta7OIwyINIQaTUJVZDOY7PyC+DUIaFmBnWw8vnul42fMXZmEIqTAoZCNy+D9++BsfTyMPXK0wYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='image 1' title='' src='/static/30868430e00f825c56a5ca65ac7c926f/ca1dc/image-1.png' srcset='/static/30868430e00f825c56a5ca65ac7c926f/e7570/image-1.png 170w,\n/static/30868430e00f825c56a5ca65ac7c926f/f46e7/image-1.png 340w,\n/static/30868430e00f825c56a5ca65ac7c926f/ca1dc/image-1.png 680w,\n/static/30868430e00f825c56a5ca65ac7c926f/02d09/image-1.png 1020w,\n/static/30868430e00f825c56a5ca65ac7c926f/994d6/image-1.png 1093w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">simple_upload</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n    form <span class=\"token operator\">=</span> SimpleUploadForm<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>POST<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span>FILES<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> form<span class=\"token punctuation\">.</span>is_valid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        myfile <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>FILES<span class=\"token punctuation\">[</span><span class=\"token string\">'image'</span><span class=\"token punctuation\">]</span>\n        fs <span class=\"token operator\">=</span> FileSystemStorage<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        filename <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>myfile<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> myfile<span class=\"token punctuation\">)</span>\n        uploaded_file_url <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n        context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'form'</span><span class=\"token punctuation\">:</span> form<span class=\"token punctuation\">,</span> <span class=\"token string\">'uploaded_file_url'</span><span class=\"token punctuation\">:</span> uploaded_file_url<span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> render<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token string\">'opencv_webapp/simple_upload.html'</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    form <span class=\"token operator\">=</span> SimpleUploadForm<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'form'</span><span class=\"token punctuation\">:</span> form<span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> render<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token string\">'opencv_webapp/simple_upload.html'</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"얼굴-탐지-기능\" style=\"position:relative;\"><a href=\"#%EC%96%BC%EA%B5%B4-%ED%83%90%EC%A7%80-%EA%B8%B0%EB%8A%A5\" aria-label=\"얼굴 탐지 기능 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>얼굴 탐지 기능</h3>\n<p>얼굴 탐지는 업로드한 이미지에서 얼굴을 찾아주는 기능입니다. 여기서는 사용자가 이미지를 업로드한 후, 그 이미지를 분석해 얼굴을 탐지하는 과정을 구현합니다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/870c7c09684f0e71e4a2e33ee859d0cc/3e3fe/image-2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 89.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABJ0AAASdAHeZh94AAAET0lEQVR42pWUC0xTdxjFmyCb8zUd84FgHLM8oqj4LvKYCDIcLmZgfc0pECfDMQ2iRGaA+GJGQ2CbU5hCMjckqPPBBME4aIfQByAWCo7opIroLG2hgopA+9ttYcuyLIu7yUn+3//enHu+fOc7osDAQPz9/QkKCmLxYj/mzlvIgoUSZvnMxXumDzO8Z+HpNZ1pYo+Xgqiuro4atZra2jrq6+vRarU0NtrQaIdW20RT08tDZDabMRgMmEwm9Ho9vb299PX12dHf34/Vyv96RJ2mTowmI+bubh4/NtBhMGIQ6o4OPd1Pntg/sgqs1n8wW//lT7Y70a+td7hepaD9t1u03laib2mip+2h8NpCq+4e7br7vOjtoa31NlXlSn4pU3C1+Dqa+mbutGjQNTeif9SO3tw1SHihRs6JnKNUl5wlK0VK4eoI8g5Ecf5MBpn7D6NraKaz+3fOHj/KQrEvqzYHsFrqx/IlK9kSE0r2/jguF37NpdrrWKwWRGU3VZSrfqJIXkRlchaFe9ezd+ccMuIDKM/PsLfS02NGW17FsW2fIctfQ83paNa/t4xdCWtJT40h66vtFN+wEQoKr9xUcq7sLKr0ozytrEdZ8iMZCWFkbg8lLMCDiA+CKcg5zue7kljkHUJFciz5W9cweqQ7bm5TyNwXQ/a3KRQJCu0tl2rVVBw6Ruu5YvQmA6nbU5Dn5bExOAynka6MchzLuNcn4OAwjFdGurDjkyS2fBiH4/A3cXQczr7kKEpKsrlUM6SwSCWn9uJlairkxEijuVRUQvddHasWR7IoZC5Ll/niPGk2Y8aMw83lDVydx+LhNpmJ48chcnBk0wYp35/azwXFNWxzFxXfVJCcksaXu/eSGLuZXfFbeD88nNjICKovxHHuzFqW+PnjOc0dHzdv5ojnME/YHF+vt3lt1GhmuLtwInsHpRoVAxbbUDRKpB9Fs/HdlawLDEbiMZMpTp5IVyRSuudTsqOlvCOJZN6s2UhCfPkmP4bMzDh2rghlxIhXcZ3sxMm8g5Q2DBFeqVdQUHiak0mpJEWtJfdyLFtTl+E7f6WgOIHw4HAk8wOYNNmF0EV+aAtT0RRmcC3nEF+kpTB/uph1UZFcbVQPEWoUtNSpKdhzgNrvDtPf8gO5Bz/GY9oCIsKXC+1K8BSLGT9hIkslIZyJ20RF+laeddy3W8pwq5Ej6WmcV8oGV69MW0N8fAxTJ3qxPmwDuYnbhLYlTBjvxVuuzkx1dcXdTcywYY6k7d6NrvwqNwpOodc00NX2QDDpU9ru3eaiWjY4ZX2nEaVahVxeiaxSjUyu4OeKKuQyFTKZmurqG9TVNlAu3Ola2+wqBp718qKzi4HnvVj6+nn2/DkmwfzCxiMydhgxGk2Yu7qEMHgqhANCMCAEBfbzw4eDtRBEGIw2Y1j5rwASdbSbeaQz8uCuEGH6J4LbB7BY+v+CrbZaBobOFux59if+ljKWofoP9PoZQb7eyykAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='image 2' title='' src='/static/870c7c09684f0e71e4a2e33ee859d0cc/ca1dc/image-2.png' srcset='/static/870c7c09684f0e71e4a2e33ee859d0cc/e7570/image-2.png 170w,\n/static/870c7c09684f0e71e4a2e33ee859d0cc/f46e7/image-2.png 340w,\n/static/870c7c09684f0e71e4a2e33ee859d0cc/ca1dc/image-2.png 680w,\n/static/870c7c09684f0e71e4a2e33ee859d0cc/3e3fe/image-2.png 860w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">detect_face</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n        form <span class=\"token operator\">=</span> ImageUploadForm<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>POST<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span>FILES<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> form<span class=\"token punctuation\">.</span>is_valid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            post <span class=\"token operator\">=</span> form<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>commit<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n            post<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            imageURL <span class=\"token operator\">=</span> settings<span class=\"token punctuation\">.</span>MEDIA_URL <span class=\"token operator\">+</span> form<span class=\"token punctuation\">.</span>instance<span class=\"token punctuation\">.</span>document<span class=\"token punctuation\">.</span>name\n            cv_detect_face<span class=\"token punctuation\">(</span>settings<span class=\"token punctuation\">.</span>MEDIA_ROOT_URL <span class=\"token operator\">+</span> imageURL<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> render<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token string\">'opencv_webapp/detect_face.html'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'form'</span><span class=\"token punctuation\">:</span>form<span class=\"token punctuation\">,</span> <span class=\"token string\">'post'</span><span class=\"token punctuation\">:</span>post<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        form <span class=\"token operator\">=</span> ImageUploadForm<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> render<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token string\">'opencv_webapp/detect_face.html'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'form'</span><span class=\"token punctuation\">:</span>form<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><strong>POST 요청</strong>: 사용자가 이미지를 업로드하고 나면 ImageUploadForm을 통해 데이터를 검증합니다. 유효한 데이터라면, 이미지 파일을 DB에 저장하고 파일 경로를 얻어온 후, 미리 만들어둔 얼굴 탐지 함수 cv<em>detect</em>face()를 호출합니다. 이 함수는 이미지에서 얼굴을 감지하고, 그 결과를 이미지에 반영하는 역할을 합니다.</li>\n<li><strong>GET 요청</strong>: 이 경우는 사용자가 처음 접근할 때 빈 폼을 보여줍니다.</li>\n</ul>","frontmatter":{"title":"예측모델 기반 face detection 웹서비스 구현","date":"October 03, 2024","update":"October 03, 2024","tags":["opencv","django"],"series":"goormthon univ study"},"fields":{"slug":"/groomthon_study/","readingTime":{"minutes":11.415}}},"seriesList":{"edges":[{"node":{"id":"581d4e78-0d4c-5286-8bab-a61eeed9095b","fields":{"slug":"/groomthon_study/"},"frontmatter":{"title":"예측모델 기반 face detection 웹서비스 구현"}}}]},"previous":{"fields":{"slug":"/deploy2/"},"frontmatter":{"title":"Jenkins 사용해 CI/CD 파이프라인 자동화하기"}},"next":null},"pageContext":{"id":"581d4e78-0d4c-5286-8bab-a61eeed9095b","series":"goormthon univ study","previousPostId":"cafcd5fc-d5d2-5798-8fa7-9e370fe6b66a","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}